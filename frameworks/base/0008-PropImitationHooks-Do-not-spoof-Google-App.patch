From 6c535b7c1f8b28ede47ad6ecbcb8ad41049325bd Mon Sep 17 00:00:00 2001
From: Omkar Chandorkar <gotenksIN@aospa.co>
Date: Wed, 21 Dec 2022 22:33:10 +0900
Subject: [PATCH 5/6] PropImitationHooks: Do not spoof Google App

- new google weather widgets are available for everyone now

Change-Id: Ife7978a63f7857caf3d075e113a9dd44c1f80c8b
Signed-off-by: Omkar Chandorkar <gotenksIN@aospa.co>
Signed-off-by: penglezos <panagiotisegl@gmail.com>
---
 .../com/android/internal/util/PropImitationHooks.java | 11 -----------
 core/res/res/values/custom_config.xml                 |  3 ---
 core/res/res/values/custom_symbols.xml                |  3 ---
 3 files changed, 17 deletions(-)

diff --git a/core/java/com/android/internal/util/PropImitationHooks.java b/core/java/com/android/internal/util/PropImitationHooks.java
index 69ca0f1fd4b9..54ad67da524d 100644
--- a/core/java/com/android/internal/util/PropImitationHooks.java
+++ b/core/java/com/android/internal/util/PropImitationHooks.java
@@ -34,21 +34,16 @@ public class PropImitationHooks {
     private static final String sCertifiedFp =
             Resources.getSystem().getString(R.string.config_certifiedFingerprint);
 
-    private static final String sCertifiedModel =
-            Resources.getSystem().getString(R.string.config_certifiedModel);
-
     private static final String sStockFp =
             Resources.getSystem().getString(R.string.config_stockFingerprint);
 
     private static final String PACKAGE_ARCORE = "com.google.ar.core";
     private static final String PACKAGE_FINSKY = "com.android.vending";
-    private static final String PACKAGE_VELVET = "com.google.android.googlequicksearchbox";
     private static final String PACKAGE_GMS = "com.google.android.gms";
     private static final String PROCESS_GMS_UNSTABLE = PACKAGE_GMS + ".unstable";
 
     private static volatile boolean sIsGms = false;
     private static volatile boolean sIsFinsky = false;
-    private static volatile boolean sIsVelvet = false;
 
     public static void setProps(Application app) {
         final String packageName = app.getPackageName();
@@ -60,20 +55,14 @@ public class PropImitationHooks {
 
         sIsGms = packageName.equals(PACKAGE_GMS) && processName.equals(PROCESS_GMS_UNSTABLE);
         sIsFinsky = packageName.equals(PACKAGE_FINSKY);
-        sIsVelvet = packageName.equals(PACKAGE_VELVET);
 
         /* Set Certified Fingerprint for GMSCore or Finsky
-         * Set Certified Fingerprint and Model for Velvet
          * Set Stock Fingerprint for ARCore
          */
         if (!sCertifiedFp.isEmpty() && sIsGms) {
             dlog("Spoofing buid for GMS");
             setPropValue("FINGERPRINT", sCertifiedFp);
             setPropValue("MODEL", Build.MODEL + "\u200b");
-        } else if (!sCertifiedFp.isEmpty() && (sIsVelvet)) {
-            dlog("Setting certified fingerprint and model for: " + packageName);
-            setPropValue("FINGERPRINT", sCertifiedFp);
-            setPropValue("MODEL", sCertifiedModel);
         } else if (!sStockFp.isEmpty() && packageName.equals(PACKAGE_ARCORE)) {
             dlog("Setting stock fingerprint for: " + packageName);
             setPropValue("FINGERPRINT", sStockFp);
diff --git a/core/res/res/values/custom_config.xml b/core/res/res/values/custom_config.xml
index 37ead82a434e..70b7fa082814 100644
--- a/core/res/res/values/custom_config.xml
+++ b/core/res/res/values/custom_config.xml
@@ -3,9 +3,6 @@
     <!-- Fingerprint from a certified device against current platform SPL level -->
     <string name="config_certifiedFingerprint" translatable="false"></string>
 
-    <!-- Fingerprint from a certified model -->
-    <string name="config_certifiedModel" translatable="false"></string>
-
     <!-- Fingerprint from stock ROM -->
     <string name="config_stockFingerprint" translatable="false"></string>
 
diff --git a/core/res/res/values/custom_symbols.xml b/core/res/res/values/custom_symbols.xml
index c382644fc850..3bb4834c99f4 100644
--- a/core/res/res/values/custom_symbols.xml
+++ b/core/res/res/values/custom_symbols.xml
@@ -3,9 +3,6 @@
     <!-- Fingerprint from a certified device against current platform SPL level -->
     <java-symbol type="string" name="config_certifiedFingerprint" />
 
-    <!-- Fingerprint from a certified model -->
-    <java-symbol type="string" name="config_certifiedModel" />
-
     <!-- Fingerprint from stock ROM -->
     <java-symbol type="string" name="config_stockFingerprint" />
 </resources>
-- 
2.39.1

